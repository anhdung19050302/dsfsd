"use strict";var updateCvScreenshotStatus=function updateCvScreenshotStatus(t){"cv_screenshot_status"===t.message_type&&"updated"===t.payload.status&&(navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"channel_message",msg:t}),document.querySelectorAll('.cv[data-cv-id="'+t.payload.id+'"] .cv-screenshot-in-grid img').forEach(function(e){window.asyncSetImage(e,t.payload.url)}))};document.addEventListener("turbolinks:load",function(){Array.from(document.querySelectorAll(".cv-screenshot-in-grid img")).forEach(function(e){window.asyncSetImage(e)})}),document.addEventListener("DOMContentLoaded",function(){window.siteEventChannel&&window.siteEventChannel.registerHdr(updateCvScreenshotStatus)});var previewCvOnKeyDown=function previewCvOnKeyDown(e){"Escape"===e.key&&closePreviewCv()},previewExample=function previewExample(e){document.querySelectorAll(".cv-preview-modal")[0].classList.remove("hidden");var t=e.currentTarget.attributes["data-url"].value;document.addEventListener("keydown",previewCvOnKeyDown),ReactOnRails.render("PreviewRoot",{url:t,closePreviewModal:closePreviewCv,withBackground:!1,withHeader:!0},"preview-modal-content"),document.body.style.overflow="hidden"},closePreviewCv=function closePreviewCv(){document.removeEventListener("keydown",previewCvOnKeyDown),document.body.style.overflow=null,document.querySelectorAll(".cv-preview-modal")[0].classList.add("hidden"),ReactOnRails.unmount(document.getElementById("preview-modal-content"))};document.addEventListener("turbolinks:load",function(){Array.from(document.querySelectorAll(".landing_pages_templates_for_job_role .preview-example")).forEach(function(e){return e.onclick=function(e){e.preventDefault(),previewExample(e)}})});previewCvOnKeyDown=function previewCvOnKeyDown(e){"Escape"===e.key&&closePreviewCv()};var downloadCvOnKeyDown=function downloadCvOnKeyDown(e){"Escape"===e.key&&closeDownloadCv()},duplicateCvOnKeyDown=function duplicateCvOnKeyDown(e){"Escape"===e.key&&closeDuplicateCv()},previewCvByUrl=function previewCvByUrl(e){document.querySelectorAll(".cv-preview-modal")[0].classList.remove("hidden"),document.addEventListener("keydown",previewCvOnKeyDown),ReactOnRails.render("PreviewRoot",{url:e,closePreviewModal:closePreviewCv,withBackground:!1,withHeader:!0,withDownload:!1,updatePages:!1},"preview-modal-content"),document.body.style.overflow="hidden"},previewCv=function previewCv(e){var t=e.currentTarget.attributes["data-url"].value;previewCvByUrl(t)},sessionKey=(closePreviewCv=function closePreviewCv(){document.removeEventListener("keydown",previewCvOnKeyDown),document.body.style.overflow=null,document.querySelectorAll(".cv-preview-modal")[0].classList.add("hidden"),ReactOnRails.unmount(document.getElementById("preview-modal-content"))},undefined),downloadCv=function downloadCv(e){document.addEventListener("keydown",downloadCvOnKeyDown),document.querySelectorAll(".cv-download-modal")[0].classList.remove("hidden");var t=document.querySelector('meta[name="client-type"]').getAttribute("content");sessionKey=e.currentTarget.attributes["data-session-key"].value;var n=e.currentTarget.attributes["data-cv-id"].value,o=e.currentTarget.attributes["data-cv-name"].value;window.siteEventChannel&&window.siteEventChannel.addSession(sessionKey);var r={cv_id:n,cv_name:o,client_type:t,session_key:sessionKey,disableMagicLink:!0,closeDownloadModal:closeDownloadCv};ReactOnRails.render("DownloadRoot",r,"download-modal-content")},closeDownloadCv=function closeDownloadCv(){window.siteEventChannel&&window.siteEventChannel.removeSession(sessionKey),document.removeEventListener("keydown",downloadCvOnKeyDown),document.body.style.overflow=null,document.querySelectorAll(".cv-download-modal")[0].classList.add("hidden"),ReactOnRails.unmount(document.getElementById("download-modal-content"))},duplicateCv=function duplicateCv(e){document.addEventListener("keydown",duplicateCvOnKeyDown),document.querySelectorAll(".cv-duplicate-modal")[0].classList.remove("hidden");var t=e.currentTarget.attributes["data-cv-id"].value,n=e.currentTarget.attributes["data-cv-name"].value;window.siteEventChannel&&window.siteEventChannel.addSession(sessionKey);var o={cv_id:t,cv_name:n,session_key:sessionKey,closeDuplicateModal:closeDuplicateCv};ReactOnRails.render("DuplicateRoot",o,"duplicate-modal-content")},closeDuplicateCv=function closeDuplicateCv(){window.siteEventChannel&&window.siteEventChannel.removeSession(sessionKey),document.removeEventListener("keydown",duplicateCvOnKeyDown),document.body.style.overflow=null,document.querySelectorAll(".cv-duplicate-modal")[0].classList.add("hidden"),ReactOnRails.unmount(document.getElementById("duplicate-modal-content"))};document.addEventListener("turbolinks:load",function(){$("body.cvs_index").exists(function(){var t=$(".cvs .cv");Array.from(document.querySelectorAll(".cv-action-panel .edit")).forEach(function(e){return e.onclick=function(e){return Turbolinks.visit(e.currentTarget.attributes["data-url"].value)}}),Array.from(document.querySelectorAll(".cv-action-panel .preview")).forEach(function(e){return e.onclick=function(e){t.trigger("mouseleave"),previewCv(e)}}),Array.from(document.querySelectorAll(".cv-action-panel .download")).forEach(function(e){return e.onclick=function(e){t.trigger("mouseleave"),downloadCv(e)}}),Array.from(document.querySelectorAll(".cv-action-panel .duplicate")).forEach(function(e){return e.onclick=function(e){t.trigger("mouseleave"),duplicateCv(e)}}),Array.from(document.querySelectorAll(".cv-action-panel .delete")).forEach(function(e){return e.onclick=function(e){t.trigger("mouseleave");var n=e.currentTarget;e.preventDefault(),swal({title:"Are you sure?",text:"Do you really want to delete this CV?",type:"warning",showCancelButton:!0,focusCancel:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Xo\xe1"}).then(function(e){if(e.value){var t=n.attributes["data-url"].value;window.FetchWithCredentials(t,{method:"DELETE"}).then(function(){location.reload()})}})}});var e=document.querySelectorAll(".cv-preview-modal .close-button")[0];e&&(e.onclick=closePreviewCv);var n=window.location.search.match(/^\?preview=([\d]+)/);if(n){var o=n[1],r=$(".cv[data-cv-id="+o+"] .cv-action-panel .preview");0<r.length&&previewCvByUrl(r.attr("data-url"))}})});var showInvitationForm=function showInvitationForm(){document.querySelectorAll(".invitation-form")[0].classList.remove("hidden");var e=$(".greet-user b").text(),t={hideWatermarkGuide:closeInvitationForm,senderName:e};ReactOnRails.render("WatermarkRoot",t,"invitation-form-content")},closeInvitationForm=function closeInvitationForm(){document.querySelectorAll(".invitation-form")[0].classList.add("hidden"),ReactOnRails.unmount(document.getElementById("invitation-form-content"))};document.addEventListener("turbolinks:load",function(){var e=$(".invite-email")[0];e&&(e.onclick=function(e){e.preventDefault(),showInvitationForm(e)})}),document.addEventListener("turbolinks:load",function(){var o=document.querySelector("#restore_session");o&&Array.from(o.querySelectorAll(".unsaved-session")).forEach(function(n){return n.querySelector(".abandon-edit").onclick=function(e){var t=e.currentTarget.attributes["data-url"].value;window.FetchWithCredentials(t,{method:"DELETE"}).then(function(e){if(204!==e.status)throw new Error("Unexpected response from server");n.remove(),0===o.querySelectorAll(".unsaved-session").length&&o.remove()})["catch"](function(){return undefined})}})});var updateTemplateScreenshotStatus=function updateTemplateScreenshotStatus(t){"template_screenshot_status"===t.message_type&&"updated"===t.payload.status&&(navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"channel_message",msg:t}),document.querySelectorAll('.template[data-template-id="'+t.payload.template_id+'"] .template-screenshot-in-grid img').forEach(function(e){window.asyncSetImage(e,t.payload.url)}))};document.addEventListener("turbolinks:load",function(){Array.from(document.querySelectorAll(".template-screenshot-in-grid img")).forEach(function(e){window.asyncSetImage(e)})}),document.addEventListener("DOMContentLoaded",function(){window.siteEventChannel&&window.siteEventChannel.registerHdr(updateTemplateScreenshotStatus)});